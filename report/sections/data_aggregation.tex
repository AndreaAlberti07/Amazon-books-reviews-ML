\subsection*{Data aggregation}

The MapReduce job was created to perform the inner join operation on the "Data table" and the "Rating table" based on the title.
The output of the MapReduce job is a single file containing the joined records from both tables.

\subsubsection*{Mapper}
The Mapper script processes the input data line by line, where each line represents a distinct record.
It transforms these lines into a key-value structure, where the key corresponds to the book title, and
the value contains the remaining content of the line.\\
Given that the Mapper deals with data from two distinct sources,
it becomes crucial to distinguish between records belonging to the 'Data table' and those in the 'Rating table'.
This distinction is essential because it mandates a specific order of processing records from the 'Data'
table need to be joined with corresponding records from the 'Rating' table in the Reducer phase.
Consequently, the Reducer should process 'Data' table records before 'Rating' table records.
To ensure this orderly processing, the Mapper augments the key with a special character for each table type.
Specifically, it appends a hyphen ('-') as the second key element for records from the 'Data table' and 'www'
for records from the 'Rating table.'
By doing so, and thanks to Hadoop's sorting task made after, the Mapper guarantees that 'Data table' records are encountered
and processed prior to 'Rating table' records during the subsequent phases of MapReduce.

\subsubsection*{Reducer}

The Reducer script is responsible for processing the intermediate output records generated by the Mapper.
Its primary role is to perform the join operation between the 'Data' table and the 'Rating' table,
taking advantage of the pre-sorting of records by title.
During its execution, the Reducer reads the records in a sequential order.
As it encounters a record from the 'Data' table, it stores the information in one variable.
Conversely, when it comes across a record from the 'Rating' table, it stores that information in another variable.
Once both 'Data' and 'Rating' records for the same title are available,
the Reducer performs the join operation by combining the data from these records.
